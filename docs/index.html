<!DOCTYPE html>
<html lang="en">
  <head>
    <title>ViSearchWidgets  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="ViSearchWidgets  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">ViSearchWidgets Docs</a> (66% documented)</p>
        <p class="header-right"><a href="https://github.com/visenze/visearch-widget-swift"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">ViSearchWidgets Reference</a>
        <img id="carat" src="img/carat.png" />
        ViSearchWidgets  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/CameraGlobals.html">CameraGlobals</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CameraView.html">CameraView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CameraViewController.html">CameraViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ConfirmViewController.html">ConfirmViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ImageFetcher.html">ImageFetcher</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/PhotoLibraryViewController.html">PhotoLibraryViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RangeSliderThumbLayer.html">RangeSliderThumbLayer</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RangeSliderTrackLayer.html">RangeSliderTrackLayer</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SingleImageFetcher.html">SingleImageFetcher</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SingleImageSaver.html">SingleImageSaver</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViBaseSearchViewController.html">ViBaseSearchViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViColorPickerModalViewController.html">ViColorPickerModalViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViColorSearchViewController.html">ViColorSearchViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViFilterCategoryViewController.html">ViFilterCategoryViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViFilterItem.html">ViFilterItem</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViFilterItemCategory.html">ViFilterItemCategory</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViFilterItemCategoryOption.html">ViFilterItemCategoryOption</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViFilterItemRange.html">ViFilterItemRange</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViFilterTableView.html">ViFilterTableView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViFilterViewController.html">ViFilterViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViFindSimilarViewController.html">ViFindSimilarViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViFont.html">ViFont</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViGridSearchViewController.html">ViGridSearchViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViHorizontalSearchViewController.html">ViHorizontalSearchViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViImageView.html">ViImageView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViProduct.html">ViProduct</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViProductCardLayout.html">ViProductCardLayout</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViProductCardLayoutBuilder.html">ViProductCardLayoutBuilder</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViProductCollectionViewCell.html">ViProductCollectionViewCell</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViQueryProductLayout.html">ViQueryProductLayout</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViRangeSlider.html">ViRangeSlider</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViRangeTableViewCell.html">ViRangeTableViewCell</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViRecommendationViewController.html">ViRecommendationViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViSchemaHelper.html">ViSchemaHelper</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViSearchImageViewController.html">ViSearchImageViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViSearchResultsView.html">ViSearchResultsView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ViTheme.html">ViTheme</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes.html#/s:C15ViSearchWidgets13VolumeControl">VolumeControl</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enums</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/ImageFormat.html">ImageFormat</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ViBorderType.html">ViBorderType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ViDefaultTrackingAction.html">ViDefaultTrackingAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ViFilterItemType.html">ViFilterItemType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ViProductCardTag.html">ViProductCardTag</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ViReservedTrackingAction.html">ViReservedTrackingAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ViSearchType.html">ViSearchType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/String.html">String</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UIColor.html">UIColor</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UIFont.html">UIFont</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UIImage.html">UIImage</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UIView.html">UIView</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Functions.html#/s:F15ViSearchWidgets9takePhotoFTCSo25AVCaptureStillImageOutput16videoOrientationOSC25AVCaptureVideoOrientation8cropSizeVSC6CGSize10completionFGSqCSo7UIImage_T__T_">takePhoto(_:videoOrientation:cropSize:completion:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/ViColorPickerDelegate.html">ViColorPickerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ViFilterCategoryViewControllerDelegate.html">ViFilterCategoryViewControllerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ViFilterViewControllerDelegate.html">ViFilterViewControllerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ViProductCellDelegate.html">ViProductCellDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ViSearchViewControllerDelegate.html">ViSearchViewControllerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ViSearchViewControllerProtocol.html">ViSearchViewControllerProtocol</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structs</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/ViButtonConfig.html">ViButtonConfig</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ViIcon.html">ViIcon</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ViImageConfig.html">ViImageConfig</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ViLabelConfig.html">ViLabelConfig</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ViProductSchemaMapping.html">ViProductSchemaMapping</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Typealiases.html">Typealiases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:15ViSearchWidgets33PhotoLibraryViewSelectionComplete">PhotoLibraryViewSelectionComplete</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <a href='#visearch-swift-widgets-sdk' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='visearch-swift-widgets-sdk'>ViSearch Swift Widgets SDK</h1>
<a href='#img-src-http-img-shields-io-badge-swift-3-0-brightgreen-svg-alt-swift-nbsp-a-href-https-github-com-carthage-carthage-img-src-https-img-shields-io-badge-carthage-compatible-4bc51d-svg-style-flat-alt-carthage-compatible-a-nbsp-a-href-https-github-com-visenze-visearch-widget-swift-img-src-https-img-shields-io-cocoapods-v-visearchwidgets-svg-alt-cocoapods-a' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='img-src-http-img-shields-io-badge-swift-3-0-brightgreen-svg-alt-swift-nbsp-a-href-https-github-com-carthage-carthage-img-src-https-img-shields-io-badge-carthage-compatible-4bc51d-svg-style-flat-alt-carthage-compatible-a-nbsp-a-href-https-github-com-visenze-visearch-widget-swift-img-src-https-img-shields-io-cocoapods-v-visearchwidgets-svg-alt-cocoapods-a'><img src="http://img.shields.io/badge/swift-3.0-brightgreen.svg" alt="Swift">&nbsp;<a href="https://github.com/Carthage/Carthage"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat" alt="Carthage Compatible"></a>&nbsp;<a href="https://github.com/visenze/visearch-widget-swift"><img src="https://img.shields.io/cocoapods/v/ViSearchWidgets.svg" alt="CocoaPods"></a></h2>

<!-- toc -->

<ul>
<li><a href="#1-overview">1. Overview</a></li>
<li><a href="#2-requirements">2. Requirements</a></li>
<li><a href="#3-setup">3. Setup</a>

<ul>
<li><a href="#31-setup-your-visenze-account">3.1 Setup your ViSenze account</a></li>
<li><a href="#32-upload-your-datafeed">3.2 Upload your datafeed</a></li>
</ul></li>
<li><a href="#4-install-the-sdk">4. Install the SDK</a>

<ul>
<li><a href="#41-cocoapods">4.1 CocoaPods</a></li>
<li><a href="#42-carthage">4.2 Carthage</a></li>
<li><a href="#43-run-demo-app">4.3 Run Demo App</a></li>
</ul></li>
<li><a href="#5-configure-the-sdk">5. Configure the SDK</a>

<ul>
<li><a href="#51-api-keys">5.1 Api Keys</a></li>
<li><a href="#52-app-permission">5.2 App Permission</a></li>
</ul></li>
<li><a href="#6-solution-widgets">6. Solution Widgets</a>

<ul>
<li><a href="#60-common-widget-configuration">6.0 Common Widget Configuration</a></li>
<li><a href="#601-product-card-schema-mapping">6.0.1 Product Card Schema Mapping</a></li>
<li><a href="#602-product-card-display-setting">6.0.2 Product Card Display Setting</a></li>
<li><a href="#603-common-search-settings">6.0.3 Common Search Settings</a></li>
<li><a href="#61-find-similar">6.1 Find Similar</a></li>
<li><a href="#62-you-may-also-like">6.2 You May Also Like</a></li>
<li><a href="#63-search-by-image">6.3 Search by Image</a></li>
<li><a href="#64-search-by-color">6.4 Search by Color</a></li>
</ul></li>
<li><a href="#7-customization">7. Customization</a>

<ul>
<li><a href="#71-filtering">7.1 Filtering</a></li>
<li><a href="#72-widgets-theme">7.2 Widgets Theme</a></li>
<li><a href="#73-advanced">7.3 Advanced</a></li>
<li><a href="#74-errors-handling">7.4 Errors Handling</a></li>
<li><a href="#75-custom-search-bar">7.5 Custom Search Bar</a></li>
<li><a href="#751-add-camera--color-picker-buttons-to-uisearchbar">7.5.1 Add Camera &amp; Color Picker Buttons to UISearchBar</a></li>
<li><a href="#752-color-picker">7.5.2 Color Picker</a></li>
<li><a href="#753-camera-button">7.5.3 Camera Button</a></li>
<li><a href="#76-orientation-changes">7.6 Orientation Changes</a></li>
</ul></li>
<li><a href="#8-implement-visenze-analytics">8. Implement ViSenze Analytics</a>

<ul>
<li><a href="#81-default-actions">8.1 Default Actions</a></li>
<li><a href="#custom-action-button-tracking">Custom Action Button Tracking</a></li>
<li><a href="#82-custom-actions">8.2 Custom Actions</a></li>
</ul></li>
</ul>

<!-- tocstop -->
<a href='#1-overview' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='1-overview'>1. Overview</h2>

<p>Search and monetize your product images with our effective, easy-to-use, and customizable SDK widgets.</p>

<p>We have launched four solutions that would be fit into your various use cases.</p>

<ul>
<li><strong>Find Similar</strong>: Automatically find visually similar items from your inventory with a simple click</li>
<li><strong>You May Also Like</strong>: Recommend products customers may like using visual recognition and custom rules</li>
<li><strong>Search by Image</strong>: Search for matching or similar items from your database with built-­in automated object recognition</li>
<li><strong>Search by Color</strong>: Search and discover products by selecting from a vast color spectrum</li>
</ul>

<p>API documentation: <a href="https://visenze.github.io/visearch-widget-swift/">https://visenze.github.io/visearch-widget-swift/</a></p>

<p>To understand quickly what our SDKs offer out of the box, please follow instructions in section 3 and then jump to section 4.3 to run the demo.</p>
<a href='#2-requirements' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='2-requirements'>2. Requirements</h2>

<ul>
<li>iOS 8.0+</li>
<li>Xcode 8.1+</li>
<li>Swift 3.0+</li>
</ul>
<a href='#3-setup' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='3-setup'>3. Setup</h2>
<a href='#3-1-setup-your-visenze-account' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='3-1-setup-your-visenze-account'>3.1 Setup your ViSenze account</h3>

<p>In order to use our widgets, please setup your ViSenze account. Please refer to our developer documentation for <a href="http://developers.visenze.com/setup/#Set-up-your-ViSenze-account">set-up instructions</a>.</p>

<p>To use the mobile widgets, you will need to get the API keys (access &amp; secret key) with <code>search-only</code> permission. </p>
<a href='#3-2-upload-your-datafeed' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='3-2-upload-your-datafeed'>3.2 Upload your datafeed</h3>

<p>For testing, you will need to upload your datafeed in ViSenze <a href="https://dashboard.visenze.com/">dashboard</a> and <a href="http://developers.visenze.com/setup/#Configure-schema-fields">configure schema fields</a> . For widgets integration, the schema fields requirements are as below:</p>

<table><thead>
<tr>
<th>Meta-data</th>
<th>Schema</th>
<th>Type</th>
<th>Required</th>
<th>Searchable</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead><tbody>
<tr>
<td>Image Id</td>
<td>im_name</td>
<td>string</td>
<td>Yes</td>
<td>Yes</td>
<td>Unique identifier for the image. Generated automatically in ViSenze dashboard.</td>
<td>red-polka-dress.jpg, 2720f503-a0d9-4516-8803-19052fbf343c</td>
</tr>
<tr>
<td>Image URL</td>
<td>im_url</td>
<td>string</td>
<td>Yes</td>
<td>No</td>
<td>URL for product image. Generated automatically in ViSenze dashboard.</td>
<td><a href="http://somesite.com/abc.jpg">http://somesite.com/abc.jpg</a></td>
</tr>
<tr>
<td>Mobile Image URL</td>
<td>custom</td>
<td>string</td>
<td>No</td>
<td>No</td>
<td>Mobile friendly image url for faster loading in mobile app. If this is not provided, im_url will be used to display product image</td>
<td><a href="http://somesite.com/small-img.png">http://somesite.com/small-img.png</a></td>
</tr>
<tr>
<td>Title</td>
<td>custom</td>
<td>string</td>
<td>Yes</td>
<td>Optional</td>
<td>Product title which will appear below product image</td>
<td>Black dress</td>
</tr>
<tr>
<td>Description</td>
<td>custom</td>
<td>text</td>
<td>No</td>
<td>Optional</td>
<td>Product description which may appear in product detail page</td>
<td>Black dress</td>
</tr>
<tr>
<td>Brand</td>
<td>custom</td>
<td>string</td>
<td>No</td>
<td>Yes</td>
<td>Optional field for displaying in the product card. Can be used for filtering.</td>
<td>Nike, Adidas</td>
</tr>
<tr>
<td>Category</td>
<td>custom</td>
<td>string</td>
<td>No</td>
<td>Yes</td>
<td>Product category. Can be used for filtering.</td>
<td>Dress, Top, Eyewear, Watch , etc</td>
</tr>
<tr>
<td>Price</td>
<td>custom</td>
<td>float/int</td>
<td>Yes</td>
<td>Yes</td>
<td>Product original retail price. Can be used for ranged filtering</td>
<td>49.99</td>
</tr>
<tr>
<td>Discount Price</td>
<td>custom</td>
<td>float/int</td>
<td>No</td>
<td>Yes</td>
<td>Discount product price. Can be used for ranged filtering</td>
<td>40.99</td>
</tr>
</tbody></table>
<a href='#4-install-the-sdk' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='4-install-the-sdk'>4. Install the SDK</h2>
<a href='#4-1-cocoapods' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='4-1-cocoapods'>4.1 CocoaPods</h3>

<p><a href="http://cocoapods.org">CocoaPods</a> is a dependency manager for Cocoa projects. You can install it with the following command:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>sudo gem install cocoapods
</code></pre>

<blockquote>
<p>CocoaPods 1.1.0+ is required to build ViSearchWidgets.</p>
</blockquote>

<p>Go to your Xcode project directory to create an empty Podfile:</p>
<pre class="highlight plaintext"><code>pod init
</code></pre>

<p>To integrate ViSearchWidgets into your Xcode project using CocoaPods, specify it in your <code>Podfile</code>:</p>
<pre class="highlight ruby"><code><span class="n">source</span> <span class="s1">'https://github.com/CocoaPods/Specs.git'</span>
<span class="n">platform</span> <span class="ss">:ios</span><span class="p">,</span> <span class="s1">'10.0'</span>
<span class="n">use_frameworks!</span>

<span class="n">target</span> <span class="s1">'&lt;Your Target Name&gt;'</span> <span class="k">do</span>
    <span class="n">pod</span> <span class="s1">'ViSearchWidgets'</span><span class="p">,</span> <span class="s1">'~&gt; 0.1'</span>
<span class="k">end</span>
</code></pre>

<p>You should change version 0.1 to the latest version of ViSearchWidgets. The version numbers can be viewed under the current Github project tags.</p>

<p>Then, run the following command:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pod install
</code></pre>
<a href='#4-2-carthage' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='4-2-carthage'>4.2 Carthage</h3>

<p><a href="https://github.com/Carthage/Carthage">Carthage</a> is a decentralized dependency manager that builds your dependencies and provides you with binary frameworks.</p>

<p>You can install Carthage with <a href="http://brew.sh/">Homebrew</a> using the following command:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>brew update
<span class="gp">$ </span>brew install carthage
</code></pre>

<p>Alternately, you can download and run the <code>Carthage.pkg</code> file for the latest <a href="https://github.com/Carthage/Carthage/releases">release</a>. </p>

<p>To integrate ViSearchWidgets into your Xcode project using Carthage:</p>

<ol>
<li>Create a <code>Cartfile</code> :</li>
</ol>
<pre class="highlight plaintext"><code> github "visenze/visearch-widget-swift" ~&gt; 0.1
</code></pre>

<p>You should change version 0.1 to the latest version of ViSearchWidgets. The version numbers can be viewed under the current Github project tags.</p>

<ol>
<li>Run <code>carthage update --platform iOS --no-use-binaries</code></li>
</ol>

<p>This will fetch dependencies (Kingfisher, LayoutKit, visearch-sdk-swift, visearch-widget-swift) into Carthage/Checkouts folder, then build the framework. </p>

<ol>
<li>On your application target&rsquo;s “General” settings tab, in the <code>Embedded Binary</code> section, drag and drop the following frameworks from the <code>Carthage/Build/iOS</code> folder:</li>
</ol>

<ul>
<li>Kingfisher.framework</li>
<li>LayoutKit.framework</li>
<li>ViSearchSDK.framework</li>
<li>ViSearchWidgets.framework<br></li>
</ul>

<p><img src="./docs/images/add_frameworks.jpg" width="600" ></p>

<p>Click on <q>Build Phases</q> tab, verify that the <q>Framework Search Path</q> includes <code>$(PROJECT_DIR)/Carthage/Build/iOS</code></p>

<ol>
<li><p>Add the following frameworks to <q>Linked Frameworks and Libraries</q> section: MediaPlayer, Photos, AVFoundation.</p></li>
<li><p>On your application target’s “Build Phases” settings tab, click the “+” icon and choose “New Run Script Phase”. Create a Run Script in which you specify your shell (ex: <code>bin/sh</code>), add the following contents to the script area below the shell:</p></li>
</ol>
<pre class="highlight shell"><code>  /usr/local/bin/carthage copy-frameworks
</code></pre>

<p>and add the paths to the frameworks you want to use under <code>Input Files</code>, e.g.:</p>
<pre class="highlight plaintext"><code>  $(SRCROOT)/Carthage/Build/iOS/Kingfisher.framework
  $(SRCROOT)/Carthage/Build/iOS/LayoutKit.framework
  $(SRCROOT)/Carthage/Build/iOS/ViSearchSDK.framework
  $(SRCROOT)/Carthage/Build/iOS/ViSearchWidgets.framework
</code></pre>

<p><img src="./docs/images/build_script.png" width="600" ></p>
<a href='#4-3-run-demo-app' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='4-3-run-demo-app'>4.3 Run Demo App</h3>

<p>The source code of the Demo application is under the <code>WidgetsExample</code> folder. Please open the WidgetsExample.xcodeproj and configure the API keys/ schema mapping to run the demo.</p>

<ul>
<li>Configure API keys:</li>
</ul>

<p>Please refer to section <a href="#31-setup-your-visenze-account">3.1</a> for instructions to get the API keys.  You can enter the <code>search-only</code> access and secret keys into the <code>ViApiKeys.plist</code> file.</p>

<p><img src="./docs/images/api_keys.png" width="600" ></p>

<ul>
<li>The demo app is built with Carthage. Please download and run the <code>Carthage.pkg</code> file for the latest <a href="https://github.com/Carthage/Carthage/releases">release</a>. After Carthage  installation, you will need to run the following command at source directory:</li>
</ul>

<p><code>carthage update --platform iOS --no-use-binaries</code> </p>

<ul>
<li>Configure schema mapping</li>
</ul>

<p>As mentioned in section <a href="#32-upload-your-datafeed">3.2</a> , you will need to upload your datafeed and configure the schema fields. The fields which hold product&rsquo;s information can then be displayed in the widgets via the <code>Product Card</code> UI component. Please see the below screenshot for example.</p>

<p><img src="./docs/images/product_card.png" width="800" ></p>

<p>You will need edit the <code>SampleData.plist</code> (the file was below ViApiKeys.plist in the <code>Configure API keys</code> section screenshot) to configure the schema mapping for your sample data feed.</p>

<p><img src="./docs/images/schema_mapping.png" width="800" ></p>

<ul>
<li><code>heading_schema_mapping</code> : refers to the schema mapping for the <code>Heading</code> field in <code>Product Card</code> component. In the screenshot, it was used to display the product title (the schema field is <code>im_title</code> which is a custom field in the feed).</li>
<li><code>label_schema_mapping</code> : refers to the schema mapping for the <code>Label</code> field in <code>Product Card</code> component. In the screenshot, it was used to display the product brand.</li>
<li><code>price_schema_mapping</code> : refers to the schema mapping for the <code>Price</code> field in <code>Product Card</code> component. In the screenshot, it was used to display the product original retail price.</li>
<li><p><code>discount_price_schema_mapping</code> : refers to the schema mapping for the <code>Discount Price</code> field in <code>Product Card</code> component. In the screenshot, it was used to display the product discount price. This is optional and may not be applicable for your data feed. </p>

<ul>
<li><code>color</code> : sample color code used for <q>Search by Color</q> widget demo.</li>
<li><code>find_similar_im_name</code> : sample im_name used for <q>Find Similar</q> widget demo. You can browse the product images in ViSenze dashboard and used any existing im_name to test.</li>
<li><code>you_may_like_im_name</code> : sample im_name used for <q>You May Also Like</q> widget demo. You can browse the product images in ViSenze dashboard and used any existing im_name to test.</li>
<li><code>filterItems</code> : configure the types of fitler used in demo app. Two types of filters are supported (Category and Range filters).</li>
<li>Configure scheme: At the final step, you will need to change the Running Scheme to <q>WidgetsExample</q>. You are now ready to run the demo app.</li>
</ul></li>
</ul>

<p><img src="./docs/images/scheme.png" width="300" ></p>
<a href='#5-configure-the-sdk' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='5-configure-the-sdk'>5. Configure the SDK</h2>
<a href='#5-1-api-keys' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='5-1-api-keys'>5.1 Api Keys</h3>

<p><code>ViSearch</code> <strong>must</strong> be initialized with an accessKey/secretKey pair <strong>before</strong> it can be used. Please refer to section <a href="#31-setup-your-visenze-account">3.1</a> on how to obtain the keys .You can do this initialization once in AppDelegate class.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">ViSearchSDK</span>
<span class="kd">import</span> <span class="kt">ViSearchWidgets</span>
<span class="o">...</span>
<span class="c1">// using default ViSearch API client which will connect to Visenze's server</span>
<span class="kt">ViSearch</span><span class="o">.</span><span class="n">sharedInstance</span><span class="o">.</span><span class="nf">setup</span><span class="p">(</span><span class="nv">accessKey</span><span class="p">:</span> <span class="s">"YOUR_ACCESS_KEY"</span><span class="p">,</span> <span class="nv">secret</span><span class="p">:</span> <span class="s">"YOUR_SECRET_KEY"</span><span class="p">)</span>

</code></pre>
<a href='#5-2-app-permission' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='5-2-app-permission'>5.2 App Permission</h3>

<ul>
<li><p><strong>App Transport Security Setting</strong> :
For loading of product images, you will need to configure the <q>App Transport Security Settings</q> option in your project&rsquo;s <code>Info.plist</code>. Please see this <a href="https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW33">link</a> and <a href="http://stackoverflow.com/questions/30731785/how-do-i-load-an-http-url-with-app-transport-security-enabled-in-ios-9/30732693#30732693">suggestions</a> for more information. If your product images URLs come from various unknown domains, you can just set <q>Arbitrary Load</q> option to <q>Yes</q>. </p></li>
<li><p><strong>Add Privacy Usage Description</strong> :</p></li>
</ul>

<p>iOS 10 now requires user permission to access camera and photo library. To use <q>Search by Image</q> solution, please add description for NSCameraUsageDescription, NSPhotoLibraryUsageDescription for accessing camera/photo library respectively in your <code>Info.plist</code>. More details can be found <a href="https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW24">here</a>.</p>

<p><img src="./docs/images/privacy.png" width="600" ></p>
<a href='#6-solution-widgets' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='6-solution-widgets'>6. Solution Widgets</h2>
<a href='#6-0-common-widget-configuration' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='6-0-common-widget-configuration'>6.0 Common Widget Configuration</h3>

<p>All of our widgets (constructed as view controller sub-classes of <a href="https://visenze.github.io/visearch-widget-swift/Classes/ViBaseSearchViewController.html">ViBaseSearchViewController</a> ) require the following common configuration steps.</p>
<a href='#6-0-1-product-card-schema-mapping' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='6-0-1-product-card-schema-mapping'>6.0.1 Product Card Schema Mapping</h4>

<p>As mentioned in section <a href="#32-upload-your-datafeed">3.2</a> , you will need to upload your datafeed and configure the schema fields. The fields which hold product&rsquo;s information can then be displayed in the widgets via the <code>Product Card</code> UI component. Please see the below screenshot for example.</p>

<p><img src="./docs/images/product_card.png" width="800" ></p>

<p>You can then configure the widgets (which are view controllers) as below:</p>
<pre class="highlight swift"><code>
<span class="c1">// create the widgets as view controller      </span>
<span class="o">...</span>
<span class="o">...</span>
<span class="c1">// configure schema mapping for product card UI component in the widget             </span>
<span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">heading</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1">// mapping for heading element e.g. for displaying product title</span>
<span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="o">...</span>   <span class="c1">// mapping for label element e.g. for displaying product brand</span>
<span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// mapping for price element e.g. for displaying product original retail price</span>
<span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">discountPrice</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// mapping for discount price element e.g. for displaying product discount price. May not be available in product feed</span>
<span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">productUrl</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// mapping for product image URL. default to "im_url" schema field.</span>

</code></pre>
<a href='#6-0-2-product-card-display-setting' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='6-0-2-product-card-display-setting'>6.0.2 Product Card Display Setting</h4>

<p>You can also configure various setting for the product card.</p>
<pre class="highlight swift"><code>
<span class="c1">// configure product image size and content mode</span>
<span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="kt">CGSize</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="n">imageWidth</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">imageHeight</span> <span class="p">)</span>
<span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">contentMode</span> <span class="o">=</span> <span class="o">.</span><span class="n">scaleAspectFill</span>

<span class="c1">// configure product card box size</span>
<span class="n">controller</span><span class="o">.</span><span class="n">itemSize</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">// add border to product card</span>
<span class="n">controller</span><span class="o">.</span><span class="n">productCardBorderColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">lightGray</span>
<span class="n">controller</span><span class="o">.</span><span class="n">productCardBorderWidth</span> <span class="o">=</span> <span class="mf">0.7</span>

<span class="c1">// add only bottom and right borders for product card</span>
<span class="n">controller</span><span class="o">.</span><span class="n">productBorderStyles</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="kt">RIGHT</span> <span class="p">,</span> <span class="o">.</span><span class="kt">BOTTOM</span><span class="p">]</span>

<span class="c1">// display a strike through text through the original retail price (if discount price is available)</span>
<span class="n">controller</span><span class="o">.</span><span class="n">priceConfig</span><span class="o">.</span><span class="n">isStrikeThrough</span> <span class="o">=</span> <span class="kc">true</span>

</code></pre>
<a href='#6-0-3-common-search-settings' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='6-0-3-common-search-settings'>6.0.3 Common Search Settings</h4>
<pre class="highlight swift"><code><span class="c1">// create search params (depending on the widget)</span>
<span class="c1">// for example, in Find Similar, You May Also Like, parameters are constructed by providing im_name:</span>
<span class="c1">// let params = ViSearchParams(imName: im_name) </span>

<span class="c1">// set various search settings</span>

<span class="c1">// limit search to return 16 most similar results</span>
<span class="n">params</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">16</span>

<span class="c1">// retrieve additional meta-data (in addition to what was mentioned in schema mapping)</span>
<span class="n">params</span><span class="o">.</span><span class="n">fl</span> <span class="o">=</span> <span class="p">[</span><span class="s">"category"</span><span class="p">]</span>

<span class="c1">// set search paramters</span>
<span class="n">controller</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
</code></pre>

<p>For advanced configuration of search parameters refer to this <a href="https://github.com/visenze/visearch-sdk-swift#6-advanced-search-parameters">link</a> .</p>
<a href='#6-1-find-similar' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='6-1-find-similar'>6.1 Find Similar</h3>

<p>Visually similar products can be actively searched by the user on the product listing or product detail screen. Our algorithm assigns appropriate weights to different attributes to determine a final similarity score, and product results are displayed in order of the score. This solution provides an opportunity for shoppers to discover other relevant results based on visual similarity. </p>

<p><img src="./docs/images/similar.png"></p>

<p>The products are displayed in a grid.</p>

<p>Below is sample code for using <q>Find Similar</q> widget. Please read section 6.0 on important configuration steps.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">ViSearchSDK</span>
<span class="kd">import</span> <span class="kt">ViSearchWidgets</span>
<span class="o">...</span>


<span class="c1">// create search parameter which will search for similar products to sample_im_name.jpg</span>
<span class="c1">// you can trigger the search from a "Similar" button from product details screen</span>
<span class="c1">// Alternately, the "Find Similar" search can be triggered in the search results by clicking on "Find Similar" button on a product card (located at bottom right)</span>
<span class="k">if</span> <span class="k">let</span> <span class="nv">params</span> <span class="o">=</span> <span class="kt">ViSearchParams</span><span class="p">(</span><span class="nv">imName</span><span class="p">:</span> <span class="s">"sample_im_name.jpg"</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// 1. create Find Similar widget</span>
    <span class="k">let</span> <span class="nv">similarController</span> <span class="o">=</span> <span class="kt">ViFindSimilarViewController</span><span class="p">()</span>

    <span class="c1">// configure max of 16 most similar results to return</span>
    <span class="n">params</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">16</span>

    <span class="c1">// 2. set search parameters</span>
    <span class="n">similarController</span><span class="o">.</span><span class="n">searchParams</span> <span class="o">=</span> <span class="n">params</span>

    <span class="c1">// 3. configure schema mapping (refer to section 6.0.1)</span>
    <span class="c1">// Assumption: your schema data feed include "im_title", "brand", "price" fields which store data for product title, brand and current price</span>
    <span class="n">similarController</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">heading</span> <span class="o">=</span> <span class="s">"im_title"</span>
    <span class="n">similarController</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s">"brand"</span>
    <span class="n">similarController</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="s">"price"</span>

    <span class="c1">// 4. configure product image size and content mode</span>
    <span class="k">let</span> <span class="nv">containerWidth</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">width</span> 
    <span class="k">let</span> <span class="nv">imageWidth</span> <span class="o">=</span> <span class="n">containerWidth</span> <span class="o">/</span> <span class="mf">2.5</span>
    <span class="k">let</span> <span class="nv">imageHeight</span> <span class="o">=</span> <span class="n">imageWidth</span> <span class="o">*</span> <span class="mf">1.2</span>

    <span class="n">similarController</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="kt">CGSize</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="n">imageWidth</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">imageHeight</span> <span class="p">)</span>
    <span class="c1">// configure image content mode</span>
    <span class="n">similarController</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">contentMode</span> <span class="o">=</span> <span class="o">.</span><span class="n">scaleAspectFill</span>

    <span class="c1">// 5. configure products to display in 2 columns</span>
    <span class="n">similarController</span><span class="o">.</span><span class="n">itemSize</span> <span class="o">=</span> <span class="n">similarController</span><span class="o">.</span><span class="nf">estimateItemSize</span><span class="p">(</span><span class="nv">numOfColumns</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nv">containerWidth</span><span class="p">:</span> <span class="n">containerWidth</span><span class="p">)</span>

    <span class="c1">// 6. misc setting (Optional)</span>
    <span class="c1">// configure border color if necessary</span>
    <span class="n">similarController</span><span class="o">.</span><span class="n">productCardBorderColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">lightGray</span>
    <span class="n">similarController</span><span class="o">.</span><span class="n">productCardBorderWidth</span> <span class="o">=</span> <span class="mf">0.7</span>

     <span class="c1">// configure spacing between product cards on the same row i.e. the column spacing</span>
    <span class="n">similarController</span><span class="o">.</span><span class="n">itemSpacing</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1">// configure spacing between the rows</span>
    <span class="n">similarController</span><span class="o">.</span><span class="n">rowSpacing</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1">// 7. configure delegate to listen for various events such as when user clicks on Action button</span>
    <span class="n">similarController</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>

    <span class="c1">// 8. open widget with navigation controller</span>
    <span class="k">self</span><span class="o">.</span><span class="n">navigationController</span><span class="p">?</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="n">similarController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>

    <span class="c1">// 9. trigger web service to ViSenze server</span>
    <span class="n">similarController</span><span class="o">.</span><span class="nf">refreshData</span><span class="p">()</span>

<span class="p">}</span>

</code></pre>

<p>Important API docs:</p>

<ul>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViFindSimilarViewController.html">ViFindSimilarViewController</a> : Find Similar widget</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViGridSearchViewController.html">ViGridSearchViewController</a> : Present search results in a grid (collection view)</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViBaseSearchViewController.html">ViBaseSearchViewController</a> : Base class for all widgets</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html">ViSearchViewControllerDelegate</a> : delegate for widget customization</li>
</ul>
<a href='#6-2-you-may-also-like' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='6-2-you-may-also-like'>6.2 You May Also Like</h3>

<p>This solution showcases recommended products on the product detail screen. You can apply custom recommendation rules for each application based on your customer demographic or other metadata such as brand, price, color etc. Our algorithm will then create a similarity score and rank products in order of score. This solution provides an opportunity for you to promote more products based on visual similarity and other relevant recommendation rules.</p>

<p><img src="./docs/images/you_may_like.png"></p>

<p>The products are displayed in a horizontal scroll view.</p>

<p>Below is sample code for using <q>You May Also Like</q> widget. Please read section 6.0 on important configuration steps. The widget (<code>ViRecommendationViewController</code>) should be used in the detail screen as a <a href="https://developer.apple.com/library/content/featuredarticles/ViewControllerPGforiPhoneOS/ImplementingaContainerViewController.html">child view controller</a>. There are 2 ways to present a child view controller.</p>

<ul>
<li>Present ViRecommendationViewController programatically as child view controller:</li>
</ul>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">ViSearchSDK</span>
<span class="kd">import</span> <span class="kt">ViSearchWidgets</span>
<span class="o">...</span>

<span class="c1">// create search parameter which will search for similar products to sample_im_name.jpg</span>
<span class="k">if</span> <span class="k">let</span> <span class="nv">params</span> <span class="o">=</span> <span class="kt">ViSearchParams</span><span class="p">(</span><span class="nv">imName</span><span class="p">:</span> <span class="s">"sample_im_name.jpg"</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// 1. create You May Also Like widget</span>
    <span class="k">let</span> <span class="nv">controller</span> <span class="o">=</span> <span class="kt">ViRecommendationViewController</span><span class="p">()</span>

    <span class="c1">// configure max of 10 most similar results to return</span>
    <span class="n">params</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="c1">// 2. set search parameters</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">searchParams</span> <span class="o">=</span> <span class="n">params</span>

    <span class="c1">// 3. configure schema mapping (refer to section 6.0.1)</span>
    <span class="c1">// Assumption: your schema data feed include "im_title", "brand", "price" fields which store data for product title, brand and current price</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">heading</span> <span class="o">=</span> <span class="s">"im_title"</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s">"brand"</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="s">"price"</span>

    <span class="c1">// 4. configure product image size and content mode</span>
    <span class="k">let</span> <span class="nv">containerWidth</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">width</span> 

    <span class="c1">// this will let 2.5 images appear on screen within containerWidth viewbox</span>
    <span class="k">let</span> <span class="nv">imageWidth</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="nf">estimateItemWidth</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="nv">containerWidth</span><span class="p">:</span> <span class="n">containerWidth</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">imageHeight</span> <span class="o">=</span> <span class="n">imageWidth</span> <span class="o">*</span> <span class="mf">1.2</span>

    <span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="kt">CGSize</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="n">imageWidth</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">imageHeight</span> <span class="p">)</span>
    <span class="c1">// configure image content mode</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">contentMode</span> <span class="o">=</span> <span class="o">.</span><span class="n">scaleAspectFill</span>

    <span class="c1">// 5. configure product card box size</span>
    <span class="c1">// IMPORTANT: this must be called last after schema mapping configuration as we calculate the item size based on whether a field is available</span>
    <span class="c1">// e.g. if label is nil in the mapping, then it will not be included in the height calculation of product card</span>
    <span class="c1">// the product card height is dynamic and will depend on schema mapping</span>
    <span class="c1">// the  product card width is set to image width            </span>
    <span class="n">controller</span><span class="o">.</span><span class="n">itemSize</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="nf">estimateItemSize</span><span class="p">()</span>

    <span class="c1">// 6. misc setting (Optional)</span>

    <span class="c1">// configure left spacing</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">paddingLeft</span> <span class="o">=</span> <span class="mf">8.0</span>

    <span class="c1">// configure border color if necessary</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">productCardBorderColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">lightGray</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">productCardBorderWidth</span> <span class="o">=</span> <span class="mf">0.7</span>

     <span class="c1">// configure spacing between product cards on the same row i.e. the column spacing</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">itemSpacing</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1">// 7. configure delegate to listen for various events such as when user clicks on Action button</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>


    <span class="c1">// 8a. if you are presenting this view programmatically i.e. not from storyboard , you will need to add the following code to present as view controller</span>

    <span class="c1">// set the frame and call necessary methods in current view controller</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="kt">CGRect</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="nv">width</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">itemSize</span><span class="o">.</span><span class="n">height</span> <span class="p">)</span>
    <span class="k">self</span><span class="o">.</span><span class="nf">addChildViewController</span><span class="p">(</span><span class="n">controller</span><span class="p">)</span>
    <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">controller</span><span class="o">.</span><span class="n">view</span><span class="p">)</span>
    <span class="n">controller</span><span class="o">.</span><span class="nf">didMove</span><span class="p">(</span><span class="nv">toParentViewController</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>

    <span class="c1">// 9. trigger web service to ViSenze server</span>
    <span class="n">controller</span><span class="o">.</span><span class="nf">refreshData</span><span class="p">()</span>

<span class="p">}</span>

</code></pre>

<ul>
<li>Present child view controller from storyboard:</li>
</ul>

<p>You will need to drag in a Container view with an embedded segue within the view controller. Instructions can be found <a href="https://developer.apple.com/library/content/featuredarticles/ViewControllerPGforiPhoneOS/ImplementingaContainerViewController.html">here</a> and also in the WidgetsExample demo.</p>

<p>Set the child controller class as ViRecommendationViewController in Interface Builder under ViSearchWidgets module.</p>

<p>Then you can set up the controller within the prepare method as below:</p>
<pre class="highlight swift"><code><span class="k">override</span> <span class="kd">func</span> <span class="nf">prepare</span><span class="p">(</span><span class="k">for</span> <span class="nv">segue</span><span class="p">:</span> <span class="kt">UIStoryboardSegue</span><span class="p">,</span> <span class="nv">sender</span><span class="p">:</span> <span class="kt">Any</span><span class="p">?)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="n">segue</span><span class="o">.</span><span class="n">identifier</span> <span class="o">==</span> <span class="s">"yourEmbedSegueIdentifier"</span> <span class="p">{</span>

     <span class="k">let</span> <span class="nv">controller</span> <span class="o">=</span> <span class="n">segue</span><span class="o">.</span><span class="n">destination</span> <span class="k">as!</span> <span class="kt">ViRecommendationViewController</span>

     <span class="k">if</span> <span class="k">let</span> <span class="nv">params</span> <span class="o">=</span> <span class="kt">ViSearchParams</span><span class="p">(</span><span class="nv">imName</span><span class="p">:</span> <span class="s">"sample_im_name.jpg"</span><span class="p">)</span> <span class="p">{</span>

      <span class="c1">//1. configure max of 10 most similar results to return</span>
      <span class="n">params</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span>

      <span class="c1">// 2. set search parameters</span>
      <span class="n">controller</span><span class="o">.</span><span class="n">searchParams</span> <span class="o">=</span> <span class="n">params</span>

      <span class="c1">// 3. configure schema mapping (refer to section 6.0.1)</span>
      <span class="c1">// Assumption: your schema data feed include "im_title", "brand", "price" fields which store data for product title, brand and current price</span>
      <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">heading</span> <span class="o">=</span> <span class="s">"im_title"</span>
      <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s">"brand"</span>
      <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="s">"price"</span>

      <span class="c1">// 4. configure product image size and content mode</span>
      <span class="k">let</span> <span class="nv">containerWidth</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">width</span> 

      <span class="c1">// this will let 2.5 images appear on screen within containerWidth viewbox</span>
      <span class="k">let</span> <span class="nv">imageWidth</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="nf">estimateItemWidth</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="nv">containerWidth</span><span class="p">:</span> <span class="n">containerWidth</span><span class="p">)</span>
      <span class="k">let</span> <span class="nv">imageHeight</span> <span class="o">=</span> <span class="n">imageWidth</span> <span class="o">*</span> <span class="mf">1.2</span>

      <span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="kt">CGSize</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="n">imageWidth</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">imageHeight</span> <span class="p">)</span>
      <span class="c1">// configure image content mode</span>
      <span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">contentMode</span> <span class="o">=</span> <span class="o">.</span><span class="n">scaleAspectFill</span>

       <span class="c1">// 5. configure product card box size</span>
       <span class="c1">// IMPORTANT: this must be called last after schema mapping configuration as we calculate the item size based on whether a field is available</span>
       <span class="c1">// e.g. if label is nil in the mapping, then it will not be included in the height calculation of product card</span>
       <span class="c1">// the product card height is dynamic and will depend on schema mapping</span>
       <span class="c1">// the  product card width is set to image width            </span>
       <span class="n">controller</span><span class="o">.</span><span class="n">itemSize</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="nf">estimateItemSize</span><span class="p">()</span>

       <span class="c1">// 6. misc setting (Optional)</span>

       <span class="c1">// configure left spacing</span>
       <span class="n">controller</span><span class="o">.</span><span class="n">paddingLeft</span> <span class="o">=</span> <span class="mf">8.0</span>

       <span class="c1">// configure border color if necessary</span>
       <span class="n">controller</span><span class="o">.</span><span class="n">productCardBorderColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">lightGray</span>
       <span class="n">controller</span><span class="o">.</span><span class="n">productCardBorderWidth</span> <span class="o">=</span> <span class="mf">0.7</span>

        <span class="c1">// configure spacing between product cards on the same row i.e. the column spacing</span>
       <span class="n">controller</span><span class="o">.</span><span class="n">itemSpacing</span> <span class="o">=</span> <span class="mi">8</span>

        <span class="c1">// 7. configure delegate to listen for various events such as when user clicks on Action button</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>


        <span class="c1">// 8. trigger web service to ViSenze server</span>
        <span class="n">controller</span><span class="o">.</span><span class="nf">refreshData</span><span class="p">()</span>

    <span class="p">}</span>     

  <span class="p">}</span>      
<span class="p">}</span>
</code></pre>

<p>Important API docs:</p>

<ul>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViRecommendationViewController.html">ViRecommendationViewController</a> : You May Also Like widget</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViHorizontalSearchViewController.html">ViHorizontalSearchViewController</a> : Present search results in a horizontall scroll view (collection view)</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViBaseSearchViewController.html">ViBaseSearchViewController</a> : Base class for all widgets</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html">ViSearchViewControllerDelegate</a> : delegate for widget customization</li>
</ul>
<a href='#6-3-search-by-image' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='6-3-search-by-image'>6.3 Search by Image</h3>

<p>Shoppers can snap or upload a photo of the product they are looking for, find the same or similar options across price points, brands etc., and order the product that best meets their needs. The solution provides an innovative and easy way for shoppers to find items they want without needing keywords.</p>

<p><img src="./docs/images/camera_preview.jpg" width="850"></p>

<p>The products are displayed in a grid.</p>

<p>Below is sample code for using <q>Search by Image</q> widget. Please read section 6.0 on important configuration steps and section 5.2 on important app permissions.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">ViSearchSDK</span>
<span class="kd">import</span> <span class="kt">ViSearchWidgets</span>
<span class="o">...</span>

<span class="c1">// the entry point for Search by Image is to open a camera to take photo</span>
<span class="c1">// 1. we use CameraViewController for photo taking / select photo</span>
<span class="k">let</span> <span class="nv">cameraViewController</span> <span class="o">=</span> <span class="kt">CameraViewController</span><span class="p">(</span><span class="nv">croppingEnabled</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">allowsLibraryAccess</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">image</span><span class="p">,</span> <span class="n">asset</span> <span class="k">in</span>

    <span class="c1">// user cancel photo taking</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">image</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="nf">dismiss</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>

    <span class="c1">// 2. create the Search by Image widget and save recent photo</span>
    <span class="k">let</span> <span class="nv">controller</span> <span class="o">=</span> <span class="kt">ViSearchImageViewController</span><span class="p">()</span>

    <span class="c1">// save recent photo asset (which can be a recent taken photo from camera)</span>
    <span class="c1">// the asset can also be from the user's photo library</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">asset</span> <span class="o">=</span> <span class="n">asset</span>

    <span class="c1">// create search parameter</span>
    <span class="k">let</span> <span class="nv">params</span> <span class="o">=</span> <span class="kt">ViUploadSearchParams</span><span class="p">(</span><span class="nv">image</span><span class="p">:</span> <span class="n">image</span><span class="o">!</span><span class="p">)</span>

    <span class="c1">// configure max of 16 most similar results to return</span>
    <span class="n">params</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">searchParams</span> <span class="o">=</span> <span class="n">params</span>

    <span class="c1">// enable cropping and select photo from library</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">croppingEnabled</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">allowsLibraryAccess</span> <span class="o">=</span> <span class="kc">true</span>

    <span class="c1">// 3. configure schema mapping (refer to section 6.0.1)</span>
    <span class="c1">// Assumption: your schema data feed include "im_title", "brand", "price" fields which store data for product title, brand and current price</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">heading</span> <span class="o">=</span> <span class="s">"im_title"</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s">"brand"</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="s">"price"</span>

    <span class="c1">// 4. configure product image size and content mode</span>
    <span class="k">let</span> <span class="nv">containerWidth</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">width</span> 
    <span class="k">let</span> <span class="nv">imageWidth</span> <span class="o">=</span> <span class="n">containerWidth</span> <span class="o">/</span> <span class="mf">2.5</span>
    <span class="k">let</span> <span class="nv">imageHeight</span> <span class="o">=</span> <span class="n">imageWidth</span> <span class="o">*</span> <span class="mf">1.2</span>

    <span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="kt">CGSize</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="n">imageWidth</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">imageHeight</span> <span class="p">)</span>
    <span class="c1">// configure image content mode</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">contentMode</span> <span class="o">=</span> <span class="o">.</span><span class="n">scaleAspectFill</span>

    <span class="c1">// 5. configure products to display in 2 columns</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">itemSize</span> <span class="o">=</span> <span class="n">similarController</span><span class="o">.</span><span class="nf">estimateItemSize</span><span class="p">(</span><span class="nv">numOfColumns</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nv">containerWidth</span><span class="p">:</span> <span class="n">containerWidth</span><span class="p">)</span>

    <span class="c1">// 6. misc setting (Optional)</span>
    <span class="c1">// configure border color if necessary</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">productCardBorderColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">lightGray</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">productCardBorderWidth</span> <span class="o">=</span> <span class="mf">0.7</span>

     <span class="c1">// configure spacing between product cards on the same row i.e. the column spacing</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">itemSpacing</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1">// configure spacing between the rows</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">rowSpacing</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1">// 7. configure delegate to listen for various events such as when user clicks on Action button</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>

    <span class="c1">// 8. open widget with navigation controller</span>
    <span class="k">self</span><span class="o">.</span><span class="n">navigationController</span><span class="p">?</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="n">similarController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>

    <span class="c1">// 9. trigger web service to ViSenze server</span>
    <span class="n">controller</span><span class="o">.</span><span class="nf">refreshData</span><span class="p">()</span>

    <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="nf">dismiss</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>

<span class="p">}</span>

<span class="c1">// present the camera to take photo or select from library</span>
<span class="nf">present</span><span class="p">(</span><span class="n">cameraViewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>

<p>You can enable/disable cropping, photo library access by setting the following properties:</p>
<pre class="highlight swift"><code><span class="c1">// if you want to enable cropping immediately after taking photo and before search</span>
<span class="c1">// just set croppingEnabled to true for CameraViewController</span>
<span class="c1">// in the widget demo, search results are displayed immediately after taking from camera. Cropping is only done later by clicking on the crop button next to the query image</span>
<span class="k">let</span> <span class="nv">cameraViewController</span> <span class="o">=</span> <span class="kt">CameraViewController</span><span class="p">(</span><span class="nv">croppingEnabled</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">allowsLibraryAccess</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span> <span class="o">...</span>

<span class="c1">// enable cropping and select photo from library</span>
<span class="n">controller</span><span class="o">.</span><span class="n">croppingEnabled</span> <span class="o">=</span> <span class="kc">true</span>
<span class="n">controller</span><span class="o">.</span><span class="n">allowsLibraryAccess</span> <span class="o">=</span> <span class="kc">true</span>

</code></pre>

<p>Important API docs:</p>

<ul>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViSearchImageViewController.html">ViSearchImageViewController</a> : Search by Image widget</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViGridSearchViewController.html">ViGridSearchViewController</a> : display search results in a grid (collection view)</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViBaseSearchViewController.html">ViBaseSearchViewController</a> : Base class for all widgets</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html">ViSearchViewControllerDelegate</a> : delegate for widget customization</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/CameraViewController.html">CameraViewController</a> : displaying the camera view for photo taking/selection from photo library</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ConfirmViewController.html">ConfirmViewController</a> : confirm controller for keeping/discarding the taken/selected photo. Cropping is done here.</li>
</ul>
<a href='#6-4-search-by-color' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='6-4-search-by-color'>6.4 Search by Color</h3>

<p>Shoppers can search your entire indexed catalogue of products for an item with a particular color and then narrow down the results by attributes or fields such as category, brand, price, etc. Our algorithm can search the catalogue by a set of pre-selected colors from a color palette or a vast spectrum of colors.</p>

<p><img src="./docs/images/color_search.png" width="850"></p>

<p>The products are displayed in a grid.</p>

<p>Below is sample code for using <q>Search by Color</q> widget. Please read section 6.0 on important configuration steps.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">ViSearchSDK</span>
<span class="kd">import</span> <span class="kt">ViSearchWidgets</span>
<span class="o">...</span>


<span class="c1">// create search parameter with color code 00ff00</span>
<span class="k">if</span> <span class="k">let</span> <span class="nv">params</span> <span class="o">=</span> <span class="kt">ViColorSearchParams</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"00ff00"</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// 1. create controller</span>
    <span class="k">let</span> <span class="nv">controller</span> <span class="o">=</span> <span class="kt">ViColorSearchViewController</span><span class="p">()</span>

    <span class="c1">// configure max of 16 most similar results to return</span>
    <span class="n">params</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">16</span>

    <span class="c1">// 2. set search parameters</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">searchParams</span> <span class="o">=</span> <span class="n">params</span>

    <span class="c1">// 3. configure schema mapping (refer to section 6.0.1)</span>
    <span class="c1">// Assumption: your schema data feed include "im_title", "brand", "price" fields which store data for product title, brand and current price</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">heading</span> <span class="o">=</span> <span class="s">"im_title"</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s">"brand"</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="s">"price"</span>

    <span class="c1">// 4. configure product image size and content mode</span>
    <span class="k">let</span> <span class="nv">containerWidth</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">width</span> 
    <span class="k">let</span> <span class="nv">imageWidth</span> <span class="o">=</span> <span class="n">containerWidth</span> <span class="o">/</span> <span class="mf">2.5</span>
    <span class="k">let</span> <span class="nv">imageHeight</span> <span class="o">=</span> <span class="n">imageWidth</span> <span class="o">*</span> <span class="mf">1.2</span>

    <span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="kt">CGSize</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="n">imageWidth</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">imageHeight</span> <span class="p">)</span>
    <span class="c1">// configure image content mode</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">contentMode</span> <span class="o">=</span> <span class="o">.</span><span class="n">scaleAspectFill</span>

    <span class="c1">// 5. configure products to display in 2 columns</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">itemSize</span> <span class="o">=</span> <span class="n">similarController</span><span class="o">.</span><span class="nf">estimateItemSize</span><span class="p">(</span><span class="nv">numOfColumns</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nv">containerWidth</span><span class="p">:</span> <span class="n">containerWidth</span><span class="p">)</span>

    <span class="c1">// 6. misc setting (Optional)</span>
    <span class="c1">// configure border color if necessary</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">productCardBorderColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">lightGray</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">productCardBorderWidth</span> <span class="o">=</span> <span class="mf">0.7</span>

     <span class="c1">// configure spacing between product cards on the same row i.e. the column spacing</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">itemSpacing</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1">// configure spacing between the rows</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">rowSpacing</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1">// 7. configure delegate to listen for various events such as when user clicks on Action button</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>

    <span class="c1">// 8. open widget with navigation controller</span>
    <span class="k">self</span><span class="o">.</span><span class="n">navigationController</span><span class="p">?</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="n">similarController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>

    <span class="c1">// 9. trigger web service to ViSenze server</span>
    <span class="n">controller</span><span class="o">.</span><span class="nf">refreshData</span><span class="p">()</span>

<span class="p">}</span>

</code></pre>

<p>Important API docs:</p>

<ul>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViColorSearchViewController.html">ViColorSearchViewController</a> : Search by Color widget</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViGridSearchViewController.html">ViGridSearchViewController</a> : for displaying search results in a grid (collection view)</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViBaseSearchViewController.html">ViBaseSearchViewController</a> : base class for all widgets</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html">ViSearchViewControllerDelegate</a> : delegate for widget customization</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViColorPickerModalViewController.html">ViColorPickerModalViewController</a> : color picker view controller. You can present this in a popover (i.e. triggered from a button click) or as a child view controller. See section 7.5.2 for example implementation.</li>
</ul>
<a href='#7-customization' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='7-customization'>7. Customization</h2>
<a href='#7-1-filtering' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='7-1-filtering'>7.1 Filtering</h3>

<p>You can configure the filter component for <code>Find Similar</code>, <code>Search by Image</code> and <code>Search by Color</code> widgets search results. Two types of filters are supported: </p>

<ul>
<li>Range filter (e.g. for price) (<a href="https://visenze.github.io/visearch-widget-swift/Classes/ViFilterItemRange.html">ViFilterItemRange</a>)</li>
<li>Multi-selection category filter (e.g. for product category, brand) (<a href="https://visenze.github.io/visearch-widget-swift/Classes/ViFilterItemCategory.html">ViFilterItemCategory</a>)</li>
</ul>

<p><img src="./docs/images/filter.jpg" width="1000"></p>

<p>The filters can be created as below:</p>
<pre class="highlight swift"><code><span class="k">var</span> <span class="nv">items</span> <span class="p">:</span> <span class="p">[</span><span class="kt">ViFilterItem</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1">// configure a 'price' range filter item</span>
<span class="c1">// Assumption: there is a int/float field named "price" in your schema data feed</span>
<span class="k">let</span> <span class="nv">min</span> <span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">let</span> <span class="nv">max</span> <span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">500</span>

<span class="k">let</span> <span class="nv">item</span> <span class="o">=</span> <span class="kt">ViFilterItemRange</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"Price Range ($)"</span><span class="p">,</span> <span class="nv">schemaMapping</span><span class="p">:</span> <span class="s">"price"</span><span class="p">,</span> <span class="nv">min</span><span class="p">:</span> <span class="n">min</span><span class="p">,</span> <span class="nv">max</span><span class="p">:</span> <span class="n">max</span><span class="p">)</span>
<span class="n">items</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

<span class="c1">// configure a category filter item for 'brand' schema field</span>
<span class="c1">// Assumption: there is a string field named 'brand' in your schema</span>
<span class="k">let</span> <span class="nv">brandString</span> <span class="o">=</span> <span class="s">"Bobeau,Coco Style,Etro,Marc Jacobs,Sister Jane,Volcom"</span>
<span class="k">let</span> <span class="nv">options</span> <span class="o">=</span> <span class="n">brandString</span><span class="o">.</span><span class="nf">components</span><span class="p">(</span><span class="nv">separatedBy</span><span class="p">:</span> <span class="s">","</span><span class="p">)</span>                          
<span class="k">var</span> <span class="nv">optionArr</span> <span class="p">:</span> <span class="p">[</span><span class="kt">ViFilterItemCategoryOption</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">o</span> <span class="k">in</span> <span class="n">options</span> <span class="p">{</span>
    <span class="n">optionArr</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span> <span class="kt">ViFilterItemCategoryOption</span><span class="p">(</span><span class="nv">option</span><span class="p">:</span> <span class="n">o</span><span class="p">)</span> <span class="p">)</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">brandFilterItem</span> <span class="o">=</span> <span class="kt">ViFilterItemCategory</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"Brand"</span><span class="p">,</span> <span class="nv">schemaMapping</span><span class="p">:</span> <span class="s">"brand"</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="n">optionArr</span><span class="p">)</span>
<span class="n">items</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">brandFilterItem</span><span class="p">)</span>

</code></pre>

<p>To display the filters, you just need to set the filterItems property of the widgets:</p>
<pre class="highlight swift"><code><span class="n">controller</span><span class="o">.</span><span class="n">filterItems</span> <span class="o">=</span> <span class="n">items</span>
</code></pre>

<p>Important API docs:</p>

<ul>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViFilterItemRange.html">ViFilterItemRange</a></li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViFilterItemCategory.html">ViFilterItemCategory</a></li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViFilterItem.html">ViFilterItem</a></li>
</ul>
<a href='#7-2-widgets-theme' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='7-2-widgets-theme'>7.2 Widgets Theme</h3>

<p>To customize the color, styles of the widgets and button, you can look at the following classes:</p>

<ul>
<li><a href="https://visenze.github.io/visearch-widget-swift/Classes/ViTheme.html">ViTheme</a> : default global configuration for text fonts, button colors, sizes, etc.</li>
</ul>

<p>You can configure via the ViTheme singleton:</p>
<pre class="highlight swift"><code> <span class="c1">// configure default font </span>
 <span class="kt">ViTheme</span><span class="o">.</span><span class="n">sharedInstance</span><span class="o">.</span><span class="n">default_font</span> <span class="o">=</span> <span class="o">...</span>

</code></pre>

<ul>
<li><a href="https://visenze.github.io/visearch-widget-swift/Structs/ViButtonConfig.html">ViButtonConfig</a> : default style for buttons</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Structs/ViLabelConfig.html">ViLabelConfig</a> : default style for labels (heading, label, price, discount price)</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Structs/ViImageConfig.html">ViImageConfig</a> : product image configuration</li>
</ul>

<p>For specific widget customization (e.g. show/hide buttons, change text/button colors, etc), refer to <a href="https://visenze.github.io/visearch-widget-swift/Classes/ViBaseSearchViewController.html#/UI%20settings">UI Settings</a> section of <code>ViBaseSearchViewController</code>.</p>
<a href='#7-3-advanced' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='7-3-advanced'>7.3 Advanced</h3>

<p>For advanced use cases where you need to create your own widgets or want to modify/extend the product card, please hook into the <a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html">ViSearchViewControllerDelegate</a> callbacks.</p>

<ul>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html#/s:FP15ViSearchWidgets30ViSearchViewControllerDelegate13configureCellFT6senderPs9AnyObject_14collectionViewCSo16UICollectionView9indexPathV10Foundation9IndexPath4cellCSo20UICollectionViewCell_T_">configureCell(sender:collectionView:indexPath:cell:)</a> : allow you to configure the product cell before displaying. You can retrieve various product card UI elements by tag in the cell.contentView e.g. cell.contentView.viewWithTag(ViProductCardTag.productImgTag.rawValue) and configure accordingly. The tags are defined <a href="https://visenze.github.io/visearch-widget-swift/Enums/ViProductCardTag.html">here</a>.</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html#/s:FP15ViSearchWidgets30ViSearchViewControllerDelegate15configureLayoutFT6senderPs9AnyObject_6layoutCSo26UICollectionViewFlowLayout_T_">configureLayout(sender:layout:)</a> : if you need to have your own controller which will change the layout for the built in collectionview.</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html">controllerWillTransition(controller:to size:with coordinator:) </a> : to reconfigure controllers when orientation changes</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html#/s:FP15ViSearchWidgets30ViSearchViewControllerDelegate24willShowSimilarControllerFT6senderPs9AnyObject_10controllerCS_27ViFindSimilarViewController14collectionViewCSo16UICollectionView9indexPathV10Foundation9IndexPath7productCS_9ViProduct_T_">willShowSimilarController(sender:controller:collectionView:indexPath:product:)</a> : configure similar controller before display.</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html#/s:FP15ViSearchWidgets30ViSearchViewControllerDelegate23willShowFilterControllerFT6senderPs9AnyObject_10controllerCS_22ViFilterViewController_T_">willShowFilterController(sender:controller:)</a> : configure filter controller before the Filter screen is shown.</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html#/s:FP15ViSearchWidgets30ViSearchViewControllerDelegate16didSelectProductFT6senderPs9AnyObject_14collectionViewCSo16UICollectionView9indexPathV10Foundation9IndexPath7productCS_9ViProduct_T_">didSelectProduct(sender:collectionView:indexPath:product:)</a> : product selection notification i.e. user tap on a product card</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html#/s:FP15ViSearchWidgets30ViSearchViewControllerDelegate15actionBtnTappedFT6senderPs9AnyObject_14collectionViewCSo16UICollectionView9indexPathV10Foundation9IndexPath7productCS_9ViProduct_T_">actionBtnTapped(sender:collectionView:indexPath:product:)</a> : action button tapped notification i.e. user tap on action button at the top right corner of a product card cell</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html#/s:FP15ViSearchWidgets30ViSearchViewControllerDelegate16similarBtnTappedFT6senderPs9AnyObject_14collectionViewCSo16UICollectionView9indexPathV10Foundation9IndexPath7productCS_9ViProduct_T_">similarBtnTapped(sender:collectionView:indexPath:product:)</a> : user tapped on similar button at the bottom right of a product card cell</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html">searchSuccess(sender:searchType:reqId:products:)</a> : the search is successful</li>
<li><a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html">searchFailed(sender:searchType:err:apiErrors:)</a> : the search is failed due to either network errors or ViSenze API errors</li>
</ul>
<a href='#7-4-errors-handling' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='7-4-errors-handling'>7.4 Errors Handling</h3>

<p>There are 2 possible types of errors when using the widgets:</p>

<ul>
<li>Errors when trying to call the API e.g. network related errors like offline/broken/time-out Internet connection</li>
<li>ViSenze search API-related errors e.g mis-configuration of search parameters, invalid API key, API limit exceeded, invalid im_name</li>
</ul>

<p>By default, the widgets will show a generic error message (i.e. <q>An error has occured. Please try again.</q> for all errors). In addition, the widgets will show a <q>No Results Found</q> for search with no results found.</p>

<p>To display custom error messages to end users, you can hook into <code>ViSearchViewControllerDelegate</code> and take appropriate actions in <a href="https://visenze.github.io/visearch-widget-swift/Protocols/ViSearchViewControllerDelegate.html">searchFailed(sender:searchType:err:apiErrors:)</a> call back.</p>
<pre class="highlight swift"><code><span class="o">...</span>

<span class="c1">// set delegate to current view controller</span>
<span class="n">controller</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>

<span class="c1">// turn off default error message display</span>
<span class="n">controller</span><span class="o">.</span><span class="n">showDefaultErrMsg</span> <span class="o">=</span> <span class="kc">false</span>

<span class="c1">// turn off default no results message display</span>
<span class="n">controller</span><span class="o">.</span><span class="n">showNoSearchResultsMsg</span> <span class="o">=</span> <span class="kc">false</span>

<span class="o">...</span>

<span class="c1">// sender here is refering to the controller that called this search</span>
<span class="c1">// hook into this to display your custom error view</span>
<span class="kd">func</span> <span class="nf">searchFailed</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">,</span> <span class="nv">searchType</span><span class="p">:</span> <span class="kt">ViSearchType</span> <span class="p">,</span> <span class="nv">err</span><span class="p">:</span> <span class="kt">Error</span><span class="p">?,</span> <span class="nv">apiErrors</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">])</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">err</span> <span class="o">=</span> <span class="n">err</span> <span class="p">{</span>
        <span class="c1">// display network error e.g. with UIAlertController</span>
        <span class="c1">// default network error are stored in err.localizedDescription</span>

    <span class="p">}</span>

    <span class="k">else</span> <span class="k">if</span> <span class="n">apiErrors</span><span class="o">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
          <span class="c1">// ViSenze server will return list of error messages in an array</span>
          <span class="k">let</span> <span class="nv">msg</span> <span class="o">=</span> <span class="n">apiErrors</span><span class="o">.</span><span class="nf">joined</span><span class="p">(</span><span class="nv">separator</span><span class="p">:</span> <span class="s">","</span><span class="p">)</span>
          <span class="c1">// display message here if necessary</span>
    <span class="p">}</span>

    <span class="c1">// you can create a custom view (UIView)</span>
    <span class="c1">// and then call</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">async</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nv">your_custom_view</span> <span class="o">=</span> <span class="o">...</span>
        <span class="n">controller</span><span class="o">.</span><span class="nf">setMsgView</span><span class="p">(</span><span class="n">your_custom_view</span><span class="p">)</span>

        <span class="c1">// display</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">showMsgView</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// hook into this to display no results found custom view</span>
<span class="kd">func</span> <span class="nf">searchSuccess</span><span class="p">(</span> <span class="nv">sender</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">,</span> <span class="nv">searchType</span><span class="p">:</span> <span class="kt">ViSearchType</span><span class="p">,</span> <span class="nv">reqId</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span> <span class="p">,</span> <span class="nv">products</span><span class="p">:</span> <span class="p">[</span><span class="kt">ViProduct</span><span class="p">])</span>
<span class="p">{</span>
     <span class="k">if</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">count</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">){</span>
        <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">async</span> <span class="p">{</span>
             <span class="k">var</span> <span class="nv">your_custom_view</span> <span class="o">=</span> <span class="o">...</span>
                <span class="n">controller</span><span class="o">.</span><span class="nf">setMsgView</span><span class="p">(</span><span class="n">your_custom_view</span><span class="p">)</span>
                <span class="c1">// display</span>
                <span class="n">controller</span><span class="o">.</span><span class="n">showMsgView</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


</code></pre>

<p>Alternately, you can subclass the view controller and override <code>displayDefaultErrMsg</code>, <code>displayNoResultsFoundMsg</code> to change the messages display.</p>
<a href='#7-5-custom-search-bar' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='7-5-custom-search-bar'>7.5 Custom Search Bar</h3>

<p>To add <q>Search by Image</q> and <q>Search by Color</q> buttons to the UISearchBar, please refer to the <code>WidgetsExample</code> project &gt; CustomSearchBarViewController class.</p>

<p><img src="./docs/images/custom_search.png"></p>
<a href='#7-5-1-add-camera-amp-color-picker-buttons-to-uisearchbar' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='7-5-1-add-camera-amp-color-picker-buttons-to-uisearchbar'>7.5.1 Add Camera &amp; Color Picker Buttons to UISearchBar</h4>

<p>You can add the camera and color picker button to UISearchBar by implementing the code below within your custom UIViewController:</p>
<pre class="highlight swift"><code>
<span class="c1">// point the searchbar to your storyboard</span>
<span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">searchBar</span><span class="p">:</span> <span class="kt">UISearchBar</span><span class="o">!</span>

<span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidAppear</span><span class="p">(</span><span class="n">_</span> <span class="nv">animated</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidAppear</span><span class="p">(</span><span class="n">animated</span><span class="p">)</span>

    <span class="c1">// retrieve the text field within UISearchBar</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">textFieldInsideSearchBar</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">searchBar</span><span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="s">"searchField"</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">UITextField</span> <span class="p">{</span>

        <span class="c1">// customize the right view to include our 2 buttons</span>
        <span class="n">textFieldInsideSearchBar</span><span class="o">.</span><span class="n">rightView</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="nf">getCameraColorSearchButtons</span><span class="p">()</span>
        <span class="n">textFieldInsideSearchBar</span><span class="o">.</span><span class="n">rightViewMode</span> <span class="o">=</span> <span class="o">.</span><span class="n">always</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="c1">/// Add color picker and search by image buttons to search bar</span>
<span class="c1">///</span>
<span class="c1">/// - Returns: custom view to be put into the UITextField of UISearchBar</span>
<span class="kd">public</span> <span class="kd">func</span> <span class="nf">getCameraColorSearchButtons</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">UIView</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">customView</span> <span class="o">=</span> <span class="kt">UIView</span><span class="p">()</span>
    <span class="n">customView</span><span class="o">.</span><span class="n">autoresizingMask</span> <span class="o">=</span> <span class="p">[</span> <span class="o">.</span><span class="n">flexibleLeftMargin</span> <span class="p">,</span> <span class="o">.</span><span class="n">flexibleRightMargin</span> <span class="p">]</span>

    <span class="k">let</span> <span class="nv">btnWidth</span> <span class="o">=</span> <span class="kt">ViIcon</span><span class="o">.</span><span class="n">camera</span><span class="o">!.</span><span class="n">width</span> <span class="o">+</span> <span class="mi">4</span>
    <span class="k">var</span> <span class="nv">floatWidth</span> <span class="o">=</span> <span class="n">btnWidth</span>

    <span class="k">let</span> <span class="nv">button</span> <span class="o">=</span> <span class="kt">UIButton</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="n">custom</span><span class="p">)</span>

    <span class="n">button</span><span class="o">.</span><span class="nf">setImage</span><span class="p">(</span><span class="kt">ViIcon</span><span class="o">.</span><span class="n">camera</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">normal</span><span class="p">)</span>
    <span class="n">button</span><span class="o">.</span><span class="nf">setImage</span><span class="p">(</span><span class="kt">ViIcon</span><span class="o">.</span><span class="n">camera</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">highlighted</span><span class="p">)</span>

    <span class="n">button</span><span class="o">.</span><span class="n">tintColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">black</span>
    <span class="n">button</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="kt">ViProductCardTag</span><span class="o">.</span><span class="n">cameraBtnTag</span><span class="o">.</span><span class="n">rawValue</span>

    <span class="n">button</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="kt">CGRect</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">width</span><span class="p">:</span> <span class="n">btnWidth</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">btnWidth</span><span class="p">)</span>


    <span class="n">button</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="kd">#selector(</span><span class="nf">self.openCameraView</span><span class="kd">)</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
    <span class="n">customView</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>

    <span class="k">let</span> <span class="nv">colorButton</span> <span class="o">=</span> <span class="kt">UIButton</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="n">custom</span><span class="p">)</span>

    <span class="n">colorButton</span><span class="o">.</span><span class="nf">setImage</span><span class="p">(</span><span class="kt">ViIcon</span><span class="o">.</span><span class="n">color_pick</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">normal</span><span class="p">)</span>
    <span class="n">colorButton</span><span class="o">.</span><span class="nf">setImage</span><span class="p">(</span><span class="kt">ViIcon</span><span class="o">.</span><span class="n">color_pick</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">highlighted</span><span class="p">)</span>

    <span class="n">colorButton</span><span class="o">.</span><span class="n">tintColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">black</span>
    <span class="c1">//colorButton.imageEdgeInsets = UIEdgeInsetsMake( 4, 4, 4, 4)</span>
    <span class="n">colorButton</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="kt">ViProductCardTag</span><span class="o">.</span><span class="n">colorPickBtnTag</span><span class="o">.</span><span class="n">rawValue</span>


    <span class="n">colorButton</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="kd">#selector(</span><span class="nf">self.openColorPicker</span><span class="kd">)</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
    <span class="n">colorButton</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="kt">CGRect</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="n">btnWidth</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">width</span><span class="p">:</span> <span class="n">btnWidth</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">btnWidth</span><span class="p">)</span>
    <span class="n">floatWidth</span> <span class="o">=</span> <span class="n">colorButton</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">btnWidth</span>

    <span class="n">customView</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">colorButton</span><span class="p">)</span>

    <span class="n">customView</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="kt">CGRect</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="mi">0</span> <span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="mi">0</span> <span class="p">,</span> <span class="nv">width</span><span class="p">:</span> <span class="n">floatWidth</span> <span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">btnWidth</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">customView</span>
<span class="p">}</span>


</code></pre>
<a href='#7-5-2-color-picker' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='7-5-2-color-picker'>7.5.2 Color Picker</h4>

<p>To implement the action for Color Picker button, you will need to implement the following code:</p>
<pre class="highlight swift"><code>
<span class="c1">// make sure your custom controller implements ViColorPickerDelegate , UIPopoverPresentationControllerDelegate</span>
<span class="c1">// UIPopoverPresentationControllerDelegate is needed to display color picker in a popover</span>
<span class="kd">class</span> <span class="kt">CustomSearchBarViewController</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="kt">ViColorPickerDelegate</span><span class="p">,</span> <span class="kt">UIPopoverPresentationControllerDelegate</span><span class="p">{</span>

<span class="o">...</span>

    <span class="k">var</span> <span class="nv">colorParms</span><span class="p">:</span> <span class="kt">ViColorSearchParams</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>

    <span class="c1">// list of colors for the color picker in hex format e.g. e0b0ff, 2abab3</span>
    <span class="n">open</span> <span class="k">var</span> <span class="nv">colorList</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">"000000"</span> <span class="p">,</span> <span class="s">"555555"</span> <span class="p">,</span> <span class="s">"9896a4"</span> <span class="p">,</span>
        <span class="s">"034f84"</span> <span class="p">,</span> <span class="s">"00afec"</span> <span class="p">,</span> <span class="s">"98ddde"</span> <span class="p">,</span>
        <span class="s">"00ffff"</span> <span class="p">,</span> <span class="s">"f5977d"</span> <span class="p">,</span> <span class="s">"91a8d0"</span><span class="p">,</span>
        <span class="s">"ea148c"</span> <span class="p">,</span> <span class="s">"f53321"</span> <span class="p">,</span> <span class="s">"d66565"</span> <span class="p">,</span>
        <span class="s">"ff00ff"</span> <span class="p">,</span> <span class="s">"a665a7"</span> <span class="p">,</span> <span class="s">"e0b0ff"</span> <span class="p">,</span>
        <span class="s">"f773bd"</span> <span class="p">,</span> <span class="s">"f77866"</span> <span class="p">,</span> <span class="s">"7a2f04"</span> <span class="p">,</span>
        <span class="s">"cc9c33"</span> <span class="p">,</span> <span class="s">"618fca"</span> <span class="p">,</span> <span class="s">"79c753"</span> <span class="p">,</span>
        <span class="s">"228622"</span> <span class="p">,</span> <span class="s">"4987ec"</span> <span class="p">,</span> <span class="s">"2abab3"</span> <span class="p">,</span>
        <span class="s">"ffffff"</span>
    <span class="p">]</span>

    <span class="c1">/// Open color picker view in a popover</span>
    <span class="c1">///</span>
    <span class="c1">/// - Parameters:</span>
    <span class="c1">///   - sender: color picker button</span>
    <span class="c1">///   - event: button event</span>
    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">openColorPicker</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">,</span> <span class="n">forEvent</span> <span class="nv">event</span><span class="p">:</span> <span class="kt">UIEvent</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">controller</span> <span class="o">=</span> <span class="kt">ViColorPickerModalViewController</span><span class="p">()</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">modalPresentationStyle</span> <span class="o">=</span> <span class="o">.</span><span class="n">popover</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">colorList</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">colorList</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">paddingLeft</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">paddingRight</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">preferredContentSize</span> <span class="o">=</span> <span class="kt">CGSize</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">300</span><span class="p">)</span>

        <span class="k">if</span> <span class="k">let</span> <span class="nv">colorParams</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">colorParms</span> <span class="p">{</span>
            <span class="n">controller</span><span class="o">.</span><span class="n">selectedColor</span> <span class="o">=</span> <span class="n">colorParams</span><span class="o">.</span><span class="n">color</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="k">let</span> <span class="nv">popoverController</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">popoverPresentationController</span> <span class="p">{</span>
            <span class="n">popoverController</span><span class="o">.</span><span class="n">sourceView</span> <span class="o">=</span> <span class="n">sender</span>
            <span class="n">popoverController</span><span class="o">.</span><span class="n">sourceRect</span> <span class="o">=</span> <span class="n">sender</span><span class="o">.</span><span class="n">bounds</span>
            <span class="n">popoverController</span><span class="o">.</span><span class="n">permittedArrowDirections</span> <span class="o">=</span> <span class="kt">UIPopoverArrowDirection</span><span class="o">.</span><span class="n">up</span>
            <span class="n">popoverController</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>

        <span class="p">}</span>

        <span class="k">self</span><span class="o">.</span><span class="nf">present</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// MARK: UIPopoverPresentationControllerDelegate</span>
    <span class="c1">// important - this is needed so that a popover will be properly shown instead of fullscreen</span>
    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">adaptivePresentationStyle</span><span class="p">(</span><span class="k">for</span> <span class="nv">controller</span><span class="p">:</span> <span class="kt">UIPresentationController</span><span class="p">,</span>
                                          <span class="nv">traitCollection</span><span class="p">:</span> <span class="kt">UITraitCollection</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIModalPresentationStyle</span><span class="p">{</span>
        <span class="k">return</span> <span class="o">.</span><span class="k">none</span>
    <span class="p">}</span>


    <span class="c1">// MARK: ViColorPickerDelegate</span>
    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">didPickColor</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="kt">ViColorPickerModalViewController</span><span class="p">,</span> <span class="nv">color</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// set the color params</span>

        <span class="k">self</span><span class="o">.</span><span class="n">colorParms</span> <span class="o">=</span> <span class="kt">ViColorSearchParams</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="n">color</span><span class="p">)</span>

        <span class="c1">// refresh data</span>
        <span class="k">let</span> <span class="nv">controller</span> <span class="o">=</span> <span class="kt">ViColorSearchViewController</span><span class="p">()</span>
        <span class="k">self</span><span class="o">.</span><span class="n">colorParms</span><span class="o">!.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">16</span>

        <span class="n">controller</span><span class="o">.</span><span class="n">searchParams</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">colorParms</span>

        <span class="c1">// configure schema mapping if needed</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span> <span class="o">=</span> <span class="o">...</span>

        <span class="c1">// configure filter</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">filterItems</span> <span class="o">=</span> <span class="o">...</span>

        <span class="k">let</span> <span class="nv">containerWidth</span> <span class="o">=</span> <span class="k">self</span><span class="o">!.</span><span class="n">view</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">width</span>

        <span class="c1">// configure product image size</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="o">...</span>                  
        <span class="n">controller</span><span class="o">.</span><span class="n">itemSize</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="nf">estimateItemSize</span><span class="p">(</span><span class="nv">numOfColumns</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nv">containerWidth</span><span class="p">:</span> <span class="n">containerWidth</span><span class="p">)</span>

        <span class="k">self</span><span class="o">.</span><span class="n">navigationController</span><span class="p">?</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>

        <span class="n">controller</span><span class="o">.</span><span class="nf">refreshData</span><span class="p">()</span>

        <span class="n">sender</span><span class="o">.</span><span class="nf">dismiss</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>


    <span class="p">}</span>


<span class="p">}</span>

</code></pre>
<a href='#7-5-3-camera-button' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='7-5-3-camera-button'>7.5.3 Camera Button</h4>

<p>To implement action for Camera button, copy the code below to trigger the camera search:</p>
<pre class="highlight swift"><code><span class="c1">// MARK: camera</span>
<span class="c1">/// Open camera to take picture</span>
<span class="c1">///</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - sender: camera button</span>
<span class="c1">///   - event: button event</span>
<span class="kd">public</span> <span class="kd">func</span> <span class="nf">openCameraView</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">,</span> <span class="n">forEvent</span> <span class="nv">event</span><span class="p">:</span> <span class="kt">UIEvent</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">cameraViewController</span> <span class="o">=</span> <span class="kt">CameraViewController</span><span class="p">(</span><span class="nv">croppingEnabled</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">allowsLibraryAccess</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">image</span><span class="p">,</span> <span class="n">asset</span> <span class="k">in</span>

        <span class="c1">// see the code in Search by Image solution</span>

        <span class="c1">// user cancel photo taking</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">image</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="nf">dismiss</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>

        <span class="k">let</span> <span class="nv">controller</span> <span class="o">=</span> <span class="kt">ViSearchImageViewController</span><span class="p">()</span>

        <span class="c1">// save recent photo</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">asset</span> <span class="o">=</span> <span class="n">asset</span>

        <span class="k">let</span> <span class="nv">params</span> <span class="o">=</span> <span class="kt">ViUploadSearchParams</span><span class="p">(</span><span class="nv">image</span><span class="p">:</span> <span class="n">image</span><span class="o">!</span><span class="p">)</span>
        <span class="n">params</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">searchParams</span> <span class="o">=</span> <span class="n">params</span>

        <span class="n">controller</span><span class="o">.</span><span class="n">croppingEnabled</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">allowsLibraryAccess</span> <span class="o">=</span> <span class="kc">true</span>

        <span class="c1">// configure your schema mapping</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">schemaMapping</span> <span class="o">=</span> <span class="o">...</span>

        <span class="c1">// configure filter items if needed</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">filterItems</span> <span class="o">=</span> <span class="o">...</span>

        <span class="c1">// sample configuration</span>
        <span class="k">let</span> <span class="nv">containerWidth</span> <span class="o">=</span> <span class="k">self</span><span class="o">!.</span><span class="n">view</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">width</span>


        <span class="c1">// configure product image size</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="o">...</span>       
        <span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">contentMode</span> <span class="o">=</span> <span class="o">.</span><span class="n">scaleAspectFill</span>

        <span class="n">controller</span><span class="o">.</span><span class="n">itemSize</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="nf">estimateItemSize</span><span class="p">(</span><span class="nv">numOfColumns</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nv">containerWidth</span><span class="p">:</span> <span class="n">containerWidth</span><span class="p">)</span>

        <span class="c1">// set to same delegate</span>
        <span class="c1">//controller.delegate = self</span>
        <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">navigationController</span><span class="p">?</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>

        <span class="n">controller</span><span class="o">.</span><span class="nf">refreshData</span><span class="p">()</span>

        <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="nf">dismiss</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nf">present</span><span class="p">(</span><span class="n">cameraViewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>

<span class="p">}</span>

</code></pre>
<a href='#7-6-orientation-changes' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='7-6-orientation-changes'>7.6 Orientation Changes</h3>

<p>To handle orientation changes e.g. you want to display 2 columns in portrait but 4 columns in landscape, you can hook into controllerWillTransition method of ViSearchViewControllerDelegate.</p>
<pre class="highlight swift"><code>
<span class="kd">func</span> <span class="nf">controllerWillTransition</span><span class="p">(</span><span class="nv">controller</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">,</span> <span class="n">to</span> <span class="nv">size</span><span class="p">:</span> <span class="kt">CGSize</span><span class="p">,</span> <span class="n">with</span> <span class="nv">coordinator</span><span class="p">:</span> <span class="kt">UIViewControllerTransitionCoordinator</span><span class="p">)</span> <span class="p">{</span>

    <span class="n">coordinator</span><span class="o">.</span><span class="nf">animate</span><span class="p">(</span><span class="nv">alongsideTransition</span><span class="p">:</span> <span class="p">{</span> <span class="n">context</span> <span class="k">in</span>
          <span class="c1">// ViGridSearchViewController is the super class of Find Similar, Search By Color, Search by Image widgets</span>
        <span class="k">if</span> <span class="n">controller</span> <span class="k">is</span> <span class="kt">ViGridSearchViewController</span> <span class="p">{</span>
            <span class="c1">// reconfigure size</span>
            <span class="k">self</span><span class="o">.</span><span class="nf">configureSize</span><span class="p">(</span><span class="nv">controller</span><span class="p">:</span> <span class="n">controller</span> <span class="k">as!</span> <span class="kt">ViGridSearchViewController</span><span class="p">)</span>
            <span class="p">(</span><span class="n">controller</span> <span class="k">as?</span> <span class="kt">ViGridSearchViewController</span><span class="p">)?</span><span class="o">.</span><span class="n">collectionView</span><span class="p">?</span><span class="o">.</span><span class="nf">reloadData</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">},</span> <span class="nv">completion</span><span class="p">:</span> <span class="p">{</span> <span class="n">context</span> <span class="k">in</span>

        <span class="c1">// after rotate</span>

    <span class="p">})</span>

<span class="p">}</span>

<span class="c1">// configure controller size during different orientation</span>
<span class="kd">public</span> <span class="kd">func</span> <span class="nf">configureSize</span><span class="p">(</span><span class="nv">controller</span><span class="p">:</span> <span class="kt">ViGridSearchViewController</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">isPortrait</span> <span class="o">=</span> <span class="kt">UIApplication</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">statusBarOrientation</span><span class="o">.</span><span class="n">isPortrait</span>
    <span class="k">let</span> <span class="nv">numOfColumns</span> <span class="o">=</span> <span class="n">isPortrait</span> <span class="p">?</span> <span class="mi">2</span> <span class="p">:</span> <span class="mi">4</span>
    <span class="k">let</span> <span class="nv">containerWidth</span> <span class="o">=</span> <span class="kt">UIScreen</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span>

    <span class="k">let</span> <span class="nv">imageWidth</span> <span class="o">=</span> <span class="n">isPortrait</span> <span class="p">?</span> <span class="p">(</span><span class="kt">UIScreen</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">2.5</span><span class="p">)</span> <span class="p">:</span> <span class="p">(</span><span class="kt">UIScreen</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">4.5</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">imageHeight</span> <span class="o">=</span> <span class="n">imageWidth</span> <span class="o">*</span> <span class="mf">1.2</span>

    <span class="n">controller</span><span class="o">.</span><span class="n">imageConfig</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="kt">CGSize</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="n">imageWidth</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">imageHeight</span> <span class="p">)</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">itemSpacing</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">rowSpacing</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1">// this must be called last after setting schema mapping</span>
    <span class="c1">// the item size is dynamic and depdend on schema mapping</span>
    <span class="c1">// For example, if label is not provided, then the estimated height would be shorter</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">itemSize</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="nf">estimateItemSize</span><span class="p">(</span><span class="nv">numOfColumns</span><span class="p">:</span> <span class="n">numOfColumns</span><span class="p">,</span> <span class="nv">containerWidth</span><span class="p">:</span> <span class="n">containerWidth</span><span class="p">)</span>

<span class="p">}</span>

</code></pre>
<a href='#8-implement-visenze-analytics' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='8-implement-visenze-analytics'>8. Implement ViSenze Analytics</h2>

<p>The analytics reports page is located in your ViSenze Dashboard and allows you to conveniently see a high-level view of the performance of each of the solutions through click metrics as well as usage statistics. With the analytics reporting tool, you can easily track the performance to quantify the value-add of our solutions through metrics such as click-through rate, add-to-wishlist rate, add-to-cart rate, and click rank.</p>
<a href='#8-1-default-actions' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='8-1-default-actions'>8.1 Default Actions</h3>

<p>Here is the default list of actions that our analytics reports support:</p>

<table><thead>
<tr>
<th style="text-align: left">Action recorded</th>
<th style="text-align: left">Description</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: left"><code>click</code></td>
<td style="text-align: left">When user click to view the detail of the product</td>
</tr>
<tr>
<td style="text-align: left"><code>add_to_cart</code></td>
<td style="text-align: left">When user click the button to add the product to cart</td>
</tr>
<tr>
<td style="text-align: left"><code>add_to_wishlist</code></td>
<td style="text-align: left">When user click the button to add the product to wishlist</td>
</tr>
</tbody></table>

<p>By integrating with our solution widgets, the implementation of tracking <code>click</code> (click on a product card on search results) and <code>add_to_wishlist</code> (click on action button which default to the heart icon) actions are already included.</p>
<a href='#custom-action-button-tracking' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='custom-action-button-tracking'>Custom Action Button Tracking</h4>

<p>By default, <code>add_to_wishlist</code> action will be tracked when you click on the action button (located at the top right corner of the product card). You can change this action to your custom action by configure the <code>actionBtnConfig</code>:</p>
<pre class="highlight swift"><code>
<span class="o">...</span>
<span class="n">controller</span><span class="o">.</span><span class="n">actionBtnConfig</span><span class="o">.</span><span class="n">actionToRecord</span> <span class="o">=</span> <span class="s">"your_custom_action"</span> 

</code></pre>
<a href='#8-2-custom-actions' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='8-2-custom-actions'>8.2 Custom Actions</h3>

<p>If you would like to track actions being performed outside of the widgets UI or you want to customize your own UI, the action tracking needs to be implemented explicitly. For each action sent, a <code>reqId</code> (request Id) needs to be sent together with the action name. The <code>reqId</code> binds the action with its triggering API calls to our service. Each time an API call is made to our service, a <code>reqId</code> will be returned in the response. Any user action that is generated by the results returned from this particular API call should be bound with its <code>reqId</code>. Please refer to the code snippets below for the implementation.</p>

<p>Our widget automatically recorded the request id of the most recent API call (Find Similar, You May Also Like, Search by Color/ Image) in the view controller (<code>ViBaseSearchViewController</code>).</p>

<p>The user action can be sent in this way with the request id:</p>
<pre class="highlight swift"><code>
<span class="k">if</span> <span class="n">sender</span> <span class="k">is</span> <span class="kt">ViBaseSearchViewController</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">controller</span> <span class="o">=</span> <span class="n">sender</span> <span class="k">as!</span> <span class="kt">ViBaseSearchViewController</span>
    <span class="k">let</span> <span class="nv">recentReqId</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">reqId</span>

    <span class="k">let</span> <span class="nv">params</span> <span class="o">=</span> <span class="kt">ViTrackParams</span><span class="p">(</span><span class="nv">reqId</span><span class="p">:</span> <span class="n">recentReqId</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="s">"custom_action"</span> <span class="p">)</span>
     <span class="n">params</span><span class="o">.</span><span class="n">imName</span> <span class="o">=</span> <span class="n">product</span><span class="o">.</span><span class="n">im_name</span>

    <span class="c1">// send tracking request to server</span>
    <span class="kt">ViSearch</span><span class="o">.</span><span class="n">sharedInstance</span><span class="o">.</span><span class="nf">track</span><span class="p">(</span><span class="nv">params</span><span class="p">:</span> <span class="n">params</span><span class="o">!</span><span class="p">,</span> <span class="nv">handler</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
<span class="p">}</span>

</code></pre>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2016 <a class="link" href="https://github.com/visenze/visearch-widget-swift" target="_blank" rel="external">ViSenze</a>. All rights reserved. (Last updated: 2016-12-12)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.7.2</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
